---
import { getLangFromUrl, useTranslations } from "../i18n/ui";
import { Building2, Calendar, Globe } from "lucide-astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const roadmap = [
    {
        date: lang === "es" ? "Ago 2024 – Jul 2025" : "Aug 2024 – Jul 2025",
        role: "Fullstack Developer",
        company: "Azteli",
        location: "Remote",
        description: lang === "es" 
            ? "Desarrollé componentes reutilizables y parte del backend para mejorar la mantenibilidad del sistema. Creé landing pages responsivas enfocadas en una mejor experiencia de usuario e implementé un catálogo digital con dashboard centralizado que facilitó la gestión de varias sucursales y mejoró la comunicación con los clientes."
            : "Developed reusable components and backend parts to improve system maintainability. Created responsive landing pages focused on user experience and implemented a digital catalog with a centralized dashboard that facilitated multi-branch management and improved client communication.",
        icon: Building2,
        tech: ["Next.js", "Astro", "NestJS", "Postgres", "Tailwind", "CSS"]
    },
    {
        date: lang === "es" ? "Nov 2024 – Ene 2025" : "Nov 2024 – Jan 2025",
        role: "Frontend Developer",
        company: "Medipraxi",
        location: "Remote",
        description: lang === "es"
            ? "Realicé mejoras en el código y formularios clínicos para optimizar la experiencia de uso. Rediseñé la interfaz haciéndola completamente responsive para dispositivos móviles e implementé componentes de menú reutilizables que agilizaron el desarrollo de nuevos formularios y mantuvieron la consistencia visual en la plataforma."
            : "Improved code and clinical forms to optimize user experience. Redesigned the interface to be fully responsive for mobile devices and implemented reusable menu components that accelerated new form development and maintained visual consistency across the platform.",
        icon: Building2,
        tech: ["React", "Redux", "Tailwind", "CSS", "TypeScript"]
    },
    {
        date: lang === "es" ? "Ene 2024 – Ago 2024" : "Jan 2024 – Aug 2024",
        role: "Fullstack Developer",
        company: "Grupo Chavon",
        location: "On-site",
        description: lang === "es"
            ? "Colaboré en la creación de un sistema de chat en tiempo real que mejoró la comunicación interna. Implementé un módulo de tickets para gestionar incidencias y un calendario dinámico para organizar tareas. Integré servicios externos como Google Drive y Pusher para el manejo de documentos y notificaciones, además de rediseñar interfaces que facilitaron la experiencia del usuario final."
            : "Collaborated on creating a real-time chat system that improved internal communication. Implemented a ticket module for incident management and a dynamic calendar for task organization. Integrated external services like Google Drive and Pusher for document handling and notifications, and redesigned interfaces to enhance the end-user experience.",
        icon: Building2,
        tech: ["Laravel", "React", "Pusher", "MySQL", "DigitalOcean"]
    },
    {
        date: lang === "es" ? "Ene 2023 – Actualidad" : "Jan 2023 – Present",
        role: lang === "es" ? "Desarrollador Web Freelance" : "Freelance Web Developer",
        company: "Independent",
        location: "Global",
        description: lang === "es"
            ? "Desarrollo sitios web, landing pages y aplicaciones web para clientes locales e internacionales, encargándome desde el levantamiento de requerimientos hasta el despliegue en producción. Creo dashboards administrativos, formularios dinámicos y sistemas de autenticación, implementando SEO técnico, optimización de rendimiento y diseño responsivo, con despliegue y mantenimiento en DigitalOcean, Cloudflare y servicios cloud."
            : "I develop websites, landing pages, and web applications for local and international clients, managing everything from requirement gathering to production deployment. I create admin dashboards, dynamic forms, and authentication systems, implementing technical SEO, performance optimization, and responsive design, deploying and maintaining projects on DigitalOcean, Cloudflare, and cloud services.",
        icon: Building2,
        tech: ["Next.js", "Astro", "Supabase", "Cloudflare", "Docker", "Tailwind", "CSS", "Redux"]
    },
];
---

<section id="process" class="py-24 md:py-32 px-6 relative overflow-hidden reveal">
    <!-- Animated background patterns -->
    <div class="absolute inset-0 -z-10 pointer-events-none opacity-20 dark:opacity-30">
        <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-primary/20 blur-[120px] rounded-full"></div>
        <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-accent/10 blur-[120px] rounded-full"></div>
    </div>

    <div class="container mx-auto max-w-6xl relative z-10">
        <!-- Section Header -->
        <div class="mb-20">
             <span class="inline-block px-3 py-1 text-[10px] font-black tracking-[0.2em] text-primary uppercase bg-primary/10 border border-primary/20 rounded-full mb-6">
                {t("experience.badge")}
            </span>
            <h2 class="text-4xl md:text-6xl font-black mb-6 text-fg tracking-tighter">
                {t("experience.title")}
            </h2>
            <div class="h-1.5 w-24 bg-primary rounded-full mb-8"></div>
            <p class="text-xl text-fg-muted leading-relaxed max-w-2xl">
                {t("experience.description")}
            </p>
        </div>

        <div class="relative">
            <!-- Timeline Path (Desktop) - Adjusted to align with dots -->
            <div class="absolute left-8 top-4 bottom-12 w-[2px] bg-linear-to-b from-primary via-primary/40 to-transparent hidden md:block"></div>

            <div class="space-y-12 md:space-y-20">
                {
                    roadmap.map((item, index) => (
                        <div class="relative pl-0 md:pl-24 group">
                            <!-- Indicator Dot -->
                            <div class="absolute left-8 top-4 w-4 h-4 -translate-x-1/2 items-center justify-center z-10 hidden md:flex">
                                <div class="w-2.5 h-2.5 rounded-full bg-primary ring-4 ring-primary/20 group-hover:scale-150 transition-transform duration-500"></div>
                            </div>

                            <div class="grid lg:grid-cols-12 gap-8 items-start">
                                <!-- Date & Meta (Left side) -->
                                <div class="lg:col-span-3 pt-2">
                                    <div class="text-primary font-black text-sm uppercase tracking-widest mb-2 flex items-center gap-2">
                                        <Calendar class="w-4 h-4" />
                                        {item.date}
                                    </div>
                                    <div class="text-fg-muted/60 text-xs font-bold uppercase tracking-wider flex items-center gap-2">
                                        <Globe class="w-3.5 h-3.5" />
                                        {item.location}
                                    </div>
                                </div>

                                <!-- Content Card -->
                                <div class="lg:col-span-9">
                                    <div class="glass p-8 md:p-10 rounded-4xl border border-glass-border hover:border-primary/30 transition-all duration-500 hover:shadow-2xl hover:shadow-primary/5 group/card">
                                        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
                                            <div>
                                                <h3 class="text-2xl md:text-3xl font-black text-fg mb-1 group-hover/card:text-primary transition-colors">
                                                    {item.role}
                                                </h3>
                                                <div class="text-lg font-bold text-fg-muted flex items-center gap-2">
                                                    <Building2 class="w-5 h-5 text-primary/50" />
                                                    {item.company}
                                                </div>
                                            </div>
                                        </div>

                                        <p class="text-fg-muted text-base md:text-lg leading-relaxed font-light text-pretty mb-8">
                                            {item.description}
                                        </p>

                                        <!-- Tech Pills -->
                                        <div class="flex flex-wrap gap-2">
                                            {item.tech.map(t => (
                                                <span class="px-2.5 py-1 rounded-lg bg-surface-lighter border border-border/50 text-[10px] font-black uppercase text-fg-muted/70">
                                                    {t}
                                                </span>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</section>

<style>
    .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s cubic-bezier(0.2, 1, 0.3, 1);
    }
    
    .reveal.active {
        opacity: 1;
        transform: translateY(0);
    }
</style>
